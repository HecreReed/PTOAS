module {
  func.func @subset_pingpong_demo() {
    %c0 = arith.constant 0 : index
    %c32 = arith.constant 32 : index
    %0 = pto.alloc_tile : <loc=ub, dtype=f32, rows=32, cols=64, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>
    %1 = pto.subset %0[%c0, %c0] sizes [32, 32] : !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=64, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>
    %2 = pto.subset %0[%c0, %c32] sizes [32, 32] : !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=64, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>
    pto.tadd ins(%1, %1 : !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=32, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>, !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=32, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>) outs(%1 : !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=32, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>)
    pto.tadd ins(%2, %2 : !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=32, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>, !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=32, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>) outs(%2 : !pto.tile_buf<loc=ub, dtype=f32, rows=32, cols=32, v_row=32, v_col=64, blayout=row_major, slayout=none_box, fractal=512, pad=0>)
    return
  }
}

